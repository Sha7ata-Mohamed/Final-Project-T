{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Scores</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">
    <style>
        .score-card {
            margin-bottom: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .card-header {
            border-radius: 10px 10px 0 0 !important;
        }
        .progress {
            height: 20px;
        }
        .table-responsive {
            border-radius: 0 0 10px 10px;
        }
        .home-btn {
            margin-top: 2rem;
        }
    </style>
</head>
<body class="bg-light">
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="text-center mb-5">
                    <h1 class="display-4">Your Quiz Results</h1>
                    <p class="lead text-muted">See how well you performed in different categories and difficulty levels</p>
                </div>
                
                <!-- Category Scores -->
                <div class="score-card bg-white">
                    <div class="card-header bg-primary text-white p-3">
                        <h2 class="h4 mb-0">Category Scores</h2>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover mb-0">
                            <thead class="table-light">
                                <tr>
                                    <th>Category</th>
                                    <th>Correct Answers</th>
                                    <th>Total Questions</th>
                                    <th>Score</th>
                                    <th>Progress</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for category in category_scores %}
                                <tr>
                                    <td><strong>{{ category.category }}</strong></td>
                                    <td>{{ category.correct_count }}</td>
                                    <td>{{ category.total_count }}</td>
                                    <td>{{ category.percentage|floatformat:1 }}%</td>
                                    <td>
                                        <div class="progress">
                                            <div class="progress-bar {% if category.percentage >= 80 %}bg-success{% elif category.percentage >= 50 %}bg-warning{% else %}bg-danger{% endif %}" 
                                                role="progressbar" 
                                                style="width: {{ category.percentage }}%" 
                                                aria-valuenow="{{ category.percentage }}" 
                                                aria-valuemin="0" 
                                                aria-valuemax="100">
                                                {{ category.percentage|floatformat:0 }}%
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="5" class="text-center">No category scores available yet. Take some quizzes!</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Difficulty Level Scores -->
                <div class="score-card bg-white">
                    <div class="card-header bg-success text-white p-3">
                        <h2 class="h4 mb-0">Difficulty Level Scores</h2>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover mb-0">
                            <thead class="table-light">
                                <tr>
                                    <th>Difficulty</th>
                                    <th>Correct Answers</th>
                                    <th>Total Questions</th>
                                    <th>Score</th>
                                    <th>Progress</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for difficulty in difficulty_scores %}
                                <tr>
                                    <td><strong>{{ difficulty.difficulty }}</strong></td>
                                    <td>{{ difficulty.correct_count }}</td>
                                    <td>{{ difficulty.total_count }}</td>
                                    <td>{{ difficulty.percentage|floatformat:1 }}%</td>
                                    <td>
                                        <div class="progress">
                                            <div class="progress-bar {% if difficulty.percentage >= 80 %}bg-success{% elif difficulty.percentage >= 50 %}bg-warning{% else %}bg-danger{% endif %}" 
                                                role="progressbar" 
                                                style="width: {{ difficulty.percentage }}%" 
                                                aria-valuenow="{{ difficulty.percentage }}" 
                                                aria-valuemin="0" 
                                                aria-valuemax="100">
                                                {{ difficulty.percentage|floatformat:0 }}%
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="5" class="text-center">No difficulty scores available yet. Take some quizzes!</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Combined Scores -->
                <div class="score-card bg-white">
                    <div class="card-header bg-info text-white p-3">
                        <h2 class="h4 mb-0">Category and Difficulty Scores</h2>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover mb-0">
                            <thead class="table-light">
                                <tr>
                                    <th>Category</th>
                                    <th>Difficulty</th>
                                    <th>Correct Answers</th>
                                    <th>Total Questions</th>
                                    <th>Score</th>
                                    <th>Progress</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for score in combined_scores %}
                                <tr>
                                    <td><strong>{{ score.category }}</strong></td>
                                    <td>{{ score.difficulty }}</td>
                                    <td>{{ score.correct_count }}</td>
                                    <td>{{ score.total_count }}</td>
                                    <td>{{ score.percentage|floatformat:1 }}%</td>
                                    <td>
                                        <div class="progress">
                                            <div class="progress-bar {% if score.percentage >= 80 %}bg-success{% elif score.percentage >= 50 %}bg-warning{% else %}bg-danger{% endif %}" 
                                                role="progressbar" 
                                                style="width: {{ score.percentage }}%" 
                                                aria-valuenow="{{ score.percentage }}" 
                                                aria-valuemin="0" 
                                                aria-valuemax="100">
                                                {{ score.percentage|floatformat:0 }}%
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="6" class="text-center">No combined scores available yet. Take some quizzes!</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="text-center home-btn">
                    <a href="/" class="btn btn-primary btn-lg">Back to Home</a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
