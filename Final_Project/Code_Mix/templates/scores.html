{% extends "base.html" %}
{% load static %}

{% block title %}Your Quiz Results{% endblock %}
{% block header %}Your Quiz Results{% endblock %}
{% block subheader %}See how you performed across categories and difficulty levels{% endblock %}

{% block content %}
  <div class="table-responsive score-card">
    <table class="table table-striped table-hover mb-0">
      <thead class="table-dark text-white">
        <tr>
          <th>Category</th>
          <th>Difficulty</th>
          <th>Correct</th>
          <th>Wrong</th>
          <th>Total</th>
          <th>Score (%)</th>
          <th>Progress</th>
        </tr>
      </thead>
      <tbody>
        {% for cat in category_data %}
          {% for score in cat.scores %}
          <tr>
            {% if forloop.first %}
            <td rowspan="{{ cat.scores|length }}">
              <span class="badge bg-success py-2 px-3 text-white">
                {{ cat.category|title }}
              </span>
            </td>
            {% endif %}
            <td>
              <span class="badge bg-warning text-dark border-warning py-2 px-3">
                {{ score.difficulty|title }}
              </span>
            </td>
            <td class="text-success">{{ score.correct_count }}</td>
            <td class="text-danger">{{ score.wrong_count }}</td>
            <td>{{ score.total_count }}</td>
            <td>{{ score.percentage|floatformat:1 }}%</td>
            <td>
              <div class="progress">
                <div class="progress-bar bg-success" role="progressbar"
                     style="width: {{ score.percentage|floatformat:1 }}%;"
                     aria-valuenow="{{ score.percentage|floatformat:0 }}"
                     aria-valuemin="0" aria-valuemax="100">
                  {{ score.percentage|floatformat:0 }}%
                </div>
              </div>
            </td>
          </tr>
          {% endfor %}
        {% endfor %}
      </tbody>
    </table>
  </div>
  <div class="mt-4 text-center">
    <a href="{% url 'home' %}" class="btn btn-success">Back to Home</a>
  </div>
{% endblock %}